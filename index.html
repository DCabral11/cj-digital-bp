<!doctype html>
<html lang="pt-PT">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jogo de Cidade | Peddy-Paper</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  </head>
  <body>
    <div class="bg-gradient"></div>
    <main class="app-shell">
      <section id="login-view" class="card visible" aria-hidden="false">
        <h1>Jogo de Cidade</h1>
        <p class="subtitle">Plataforma Peddy-Paper com ranking em tempo real</p>
        <form id="login-form" class="form-grid">
          <label>
            Username
            <input id="username" type="text" required placeholder="Ex: equipa01" />
          </label>
          <label>
            Password
            <input id="password" type="password" required placeholder="••••••••" />
          </label>
          <button type="submit">Entrar</button>
        </form>
        <p id="login-error" class="error"></p>
      </section>

      <section id="team-view" class="card hidden" hidden aria-hidden="true">
        <header class="view-header">
          <div>
            <h2 id="team-name">Equipa</h2>
            <p id="team-score" class="score-pill">Pontuação: 0</p>
          </div>
          <button id="logout-team" class="ghost">Terminar sessão</button>
        </header>
        <h3>Postos do jogo</h3>
        <p class="subtitle">Verde = por visitar • Vermelho = visitado</p>
        <div id="games-grid" class="games-grid"></div>
      </section>

      <section id="admin-view" class="card hidden" hidden aria-hidden="true">
        <header class="view-header">
          <h2>Painel de Administrador</h2>
          <div style="display:flex;gap:.6rem;flex-wrap:wrap;">
            <button id="export-admin-xlsx" class="ghost">Exportar Dashboard Excel</button>
            <button id="logout-admin" class="ghost">Terminar sessão</button>
          </div>
        </header>

        <div class="panel-grid">
          <article>
            <h3>Ranking em tempo real</h3>
            <table>
              <thead>
                <tr><th>#</th><th>Equipa</th><th>Pontos</th></tr>
              </thead>
              <tbody id="ranking-body"></tbody>
            </table>
          </article>

          <article>
            <h3>Histórico de inserções</h3>
            <table>
              <thead>
                <tr><th>Data/Hora</th><th>Equipa</th><th>Jogo</th><th>Pontos</th></tr>
              </thead>
              <tbody id="history-body"></tbody>
            </table>
          </article>
        </div>
      </section>
    </main>

    <dialog id="pin-dialog">
      <form id="pin-form" class="form-grid">
        <h3 id="dialog-title">Validar posto</h3>
        <label>
          PIN do posto
          <input id="pin-input" type="password" required maxlength="8" autocomplete="off" />
        </label>
        <label>
          Pontos obtidos
          <input id="points-input" type="number" required min="0" max="1000" step="1" value="100" />
        </label>
        <menu>
          <button id="cancel-pin" type="button" class="ghost">Cancelar</button>
          <button id="submit-pin" type="submit">Registar</button>
        </menu>
        <p id="pin-feedback" class="error"></p>
      </form>
    </dialog>

    <script src="firebase-config.js?v=7"></script>
    <script type="module" src="app.js?v=7"></script>
  </body>
</html>
